{"version":3,"file":"smart-iframe.cjs.js","sources":["../src/core/ResourceCache.js","../src/utils/htmlParser.js","../src/core/Renderer.js","../src/core/SmartIframe.js","../src/web-components/SmartIframeElement.js","../src/index.js"],"sourcesContent":["/**\n * 资源缓存层 - 解决重复请求问题的核心模块\n */\nclass ResourceCache {\n  static cache = new Map();\n  static pendingRequests = new Map();\n  static maxCacheSize = 100; // 最大缓存数量\n  static maxAge = 30 * 60 * 1000; // 30分钟过期时间\n\n  /**\n   * 带缓存的资源获取\n   * @param {string} url - 资源URL\n   * @param {Object} options - 请求选项\n   * @returns {Promise<Object>} 缓存的资源对象\n   */\n  static async fetchWithCache(url, options = {}) {\n    const normalizedUrl = this.normalizeUrl(url);\n    \n    // 检查缓存\n    if (this.cache.has(normalizedUrl)) {\n      const cached = this.cache.get(normalizedUrl);\n      \n      // 检查是否过期\n      if (Date.now() - cached.timestamp < this.maxAge) {\n        console.log(`[SmartIframe] 使用缓存: ${normalizedUrl}`);\n        return cached;\n      } else {\n        // 删除过期缓存\n        this.cache.delete(normalizedUrl);\n      }\n    }\n\n    // 检查是否有正在进行的请求\n    if (this.pendingRequests.has(normalizedUrl)) {\n      console.log(`[SmartIframe] 等待正在进行的请求: ${normalizedUrl}`);\n      return await this.pendingRequests.get(normalizedUrl);\n    }\n\n    // 发起新请求\n    console.log(`[SmartIframe] 发起新请求: ${normalizedUrl}`);\n    const requestPromise = this.performRequest(normalizedUrl, options);\n    this.pendingRequests.set(normalizedUrl, requestPromise);\n\n    try {\n      const result = await requestPromise;\n      this.pendingRequests.delete(normalizedUrl);\n      \n      // 存入缓存\n      this.addToCache(normalizedUrl, result);\n      return result;\n    } catch (error) {\n      this.pendingRequests.delete(normalizedUrl);\n      throw error;\n    }\n  }\n\n  /**\n   * 执行实际的HTTP请求\n   * @param {string} url - 请求URL\n   * @param {Object} options - 请求选项\n   * @returns {Promise<Object>} 请求结果\n   */\n  static async performRequest(url, options) {\n    try {\n      const response = await fetch(url, {\n        mode: 'cors',\n        cache: 'default',\n        ...options\n      });\n\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const contentType = response.headers.get('content-type') || '';\n      let content;\n\n      if (contentType.includes('text/') || contentType.includes('application/javascript') || contentType.includes('application/json')) {\n        content = await response.text();\n      } else {\n        // 对于二进制资源，转换为blob URL\n        const blob = await response.blob();\n        content = URL.createObjectURL(blob);\n      }\n\n      return {\n        content,\n        contentType,\n        url,\n        timestamp: Date.now(),\n        size: content.length || 0\n      };\n    } catch (error) {\n      console.error(`[SmartIframe] 请求失败: ${url}`, error);\n      throw error;\n    }\n  }\n\n  /**\n   * URL标准化处理\n   * @param {string} url - 原始URL\n   * @returns {string} 标准化后的URL\n   */\n  static normalizeUrl(url) {\n    try {\n      const urlObj = new URL(url, window.location.href);\n      // 移除fragment，保留query参数\n      urlObj.hash = '';\n      return urlObj.toString();\n    } catch (error) {\n      console.warn(`[SmartIframe] URL标准化失败: ${url}`, error);\n      return url;\n    }\n  }\n\n  /**\n   * 添加到缓存\n   * @param {string} url - URL\n   * @param {Object} data - 缓存数据\n   */\n  static addToCache(url, data) {\n    // 检查缓存大小限制\n    if (this.cache.size >= this.maxCacheSize) {\n      // 删除最旧的缓存项\n      const oldestKey = this.cache.keys().next().value;\n      this.cache.delete(oldestKey);\n      console.log(`[SmartIframe] 删除最旧缓存: ${oldestKey}`);\n    }\n\n    this.cache.set(url, data);\n    console.log(`[SmartIframe] 缓存已保存: ${url} (${data.size} bytes)`);\n  }\n\n  /**\n   * 清除缓存\n   * @param {string} url - 可选的特定URL，不传则清除全部\n   */\n  static clearCache(url = null) {\n    if (url) {\n      const normalizedUrl = this.normalizeUrl(url);\n      this.cache.delete(normalizedUrl);\n      console.log(`[SmartIframe] 已清除缓存: ${normalizedUrl}`);\n    } else {\n      this.cache.clear();\n      console.log('[SmartIframe] 已清除全部缓存');\n    }\n  }\n\n  /**\n   * 获取缓存统计信息\n   * @returns {Object} 缓存统计\n   */\n  static getCacheStats() {\n    const totalSize = Array.from(this.cache.values())\n      .reduce((sum, item) => sum + (item.size || 0), 0);\n    \n    return {\n      count: this.cache.size,\n      totalSize,\n      maxSize: this.maxCacheSize,\n      pendingRequests: this.pendingRequests.size\n    };\n  }\n\n  /**\n   * 预加载资源列表\n   * @param {Array<string>} urls - 要预加载的URL列表\n   * @returns {Promise<Array>} 预加载结果\n   */\n  static async preloadResources(urls) {\n    console.log(`[SmartIframe] 开始预加载 ${urls.length} 个资源`);\n    const promises = urls.map(url => \n      this.fetchWithCache(url).catch(error => {\n        console.warn(`[SmartIframe] 预加载失败: ${url}`, error);\n        return null;\n      })\n    );\n    \n    const results = await Promise.all(promises);\n    const successCount = results.filter(r => r !== null).length;\n    console.log(`[SmartIframe] 预加载完成: ${successCount}/${urls.length} 成功`);\n    \n    return results;\n  }\n}\n\nexport default ResourceCache; ","/**\n * HTML解析器 - 解析HTML并提取所有资源引用\n */\nclass HtmlParser {\n  /**\n   * 解析HTML内容，提取所有资源引用\n   * @param {string} html - HTML内容\n   * @param {string} baseUrl - 基础URL，用于解析相对路径\n   * @returns {Object} 解析结果\n   */\n  static parseHTML(html, baseUrl) {\n    const parser = new DOMParser();\n    const doc = parser.parseFromString(html, 'text/html');\n    \n    const resources = {\n      stylesheets: [],\n      scripts: [],\n      images: [],\n      links: [],\n      other: []\n    };\n\n    // 提取CSS资源\n    this.extractStylesheets(doc, resources, baseUrl);\n    \n    // 提取JavaScript资源\n    this.extractScripts(doc, resources, baseUrl);\n    \n    // 提取图片资源\n    this.extractImages(doc, resources, baseUrl);\n    \n    // 提取其他链接资源\n    this.extractOtherLinks(doc, resources, baseUrl);\n\n    // 处理内联样式中的URL\n    this.extractInlineStyleUrls(doc, resources, baseUrl);\n\n    return {\n      document: doc,\n      resources,\n      allUrls: this.getAllUrls(resources)\n    };\n  }\n\n  /**\n   * 提取CSS样式表\n   */\n  static extractStylesheets(doc, resources, baseUrl) {\n    const links = doc.querySelectorAll('link[rel=\"stylesheet\"], link[rel=\"preload\"][as=\"style\"]');\n    \n    links.forEach(link => {\n      const href = link.getAttribute('href');\n      if (href) {\n        const absoluteUrl = this.resolveUrl(href, baseUrl);\n        resources.stylesheets.push({\n          element: link,\n          originalUrl: href,\n          absoluteUrl,\n          type: 'stylesheet'\n        });\n      }\n    });\n\n    // 提取style标签中的@import\n    const styleTags = doc.querySelectorAll('style');\n    styleTags.forEach(style => {\n      const content = style.textContent;\n      const importMatches = content.match(/@import\\s+(?:url\\()?[\"']?([^\"')]+)[\"']?\\)?[^;]*;/g);\n      \n      if (importMatches) {\n        importMatches.forEach(match => {\n          const urlMatch = match.match(/[\"']?([^\"')]+)[\"']?/);\n          if (urlMatch && urlMatch[1]) {\n            const absoluteUrl = this.resolveUrl(urlMatch[1], baseUrl);\n            resources.stylesheets.push({\n              element: style,\n              originalUrl: urlMatch[1],\n              absoluteUrl,\n              type: 'import',\n              parentStyle: style\n            });\n          }\n        });\n      }\n    });\n  }\n\n  /**\n   * 提取JavaScript脚本\n   */\n  static extractScripts(doc, resources, baseUrl) {\n    const scripts = doc.querySelectorAll('script[src]');\n    \n    scripts.forEach(script => {\n      const src = script.getAttribute('src');\n      if (src) {\n        const absoluteUrl = this.resolveUrl(src, baseUrl);\n        resources.scripts.push({\n          element: script,\n          originalUrl: src,\n          absoluteUrl,\n          type: 'script',\n          async: script.hasAttribute('async'),\n          defer: script.hasAttribute('defer'),\n          module: script.type === 'module'\n        });\n      }\n    });\n  }\n\n  /**\n   * 提取图片资源\n   */\n  static extractImages(doc, resources, baseUrl) {\n    const images = doc.querySelectorAll('img[src], img[data-src]');\n    \n    images.forEach(img => {\n      const src = img.getAttribute('src') || img.getAttribute('data-src');\n      if (src) {\n        const absoluteUrl = this.resolveUrl(src, baseUrl);\n        resources.images.push({\n          element: img,\n          originalUrl: src,\n          absoluteUrl,\n          type: 'image'\n        });\n      }\n\n      // 处理srcset\n      const srcset = img.getAttribute('srcset');\n      if (srcset) {\n        const srcsetUrls = this.parseSrcset(srcset, baseUrl);\n        srcsetUrls.forEach(url => {\n          resources.images.push({\n            element: img,\n            originalUrl: url.originalUrl,\n            absoluteUrl: url.absoluteUrl,\n            type: 'image-srcset'\n          });\n        });\n      }\n    });\n\n    // 处理背景图片\n    const elementsWithBg = doc.querySelectorAll('[style*=\"background\"]');\n    elementsWithBg.forEach(el => {\n      const style = el.getAttribute('style');\n      const bgUrls = this.extractBackgroundUrls(style, baseUrl);\n      bgUrls.forEach(url => {\n        resources.images.push({\n          element: el,\n          originalUrl: url.originalUrl,\n          absoluteUrl: url.absoluteUrl,\n          type: 'background-image'\n        });\n      });\n    });\n  }\n\n  /**\n   * 提取其他链接资源\n   */\n  static extractOtherLinks(doc, resources, baseUrl) {\n    const links = doc.querySelectorAll('link:not([rel=\"stylesheet\"]):not([rel=\"preload\"][as=\"style\"])');\n    \n    links.forEach(link => {\n      const href = link.getAttribute('href');\n      if (href) {\n        const absoluteUrl = this.resolveUrl(href, baseUrl);\n        const rel = link.getAttribute('rel') || 'unknown';\n        \n        resources.links.push({\n          element: link,\n          originalUrl: href,\n          absoluteUrl,\n          type: 'link',\n          rel\n        });\n      }\n    });\n\n    // 处理其他可能的资源引用\n    const otherElements = doc.querySelectorAll('source[src], track[src], embed[src], object[data]');\n    otherElements.forEach(el => {\n      const src = el.getAttribute('src') || el.getAttribute('data');\n      if (src) {\n        const absoluteUrl = this.resolveUrl(src, baseUrl);\n        resources.other.push({\n          element: el,\n          originalUrl: src,\n          absoluteUrl,\n          type: el.tagName.toLowerCase()\n        });\n      }\n    });\n  }\n\n  /**\n   * 提取内联样式中的URL\n   */\n  static extractInlineStyleUrls(doc, resources, baseUrl) {\n    const elementsWithStyle = doc.querySelectorAll('[style]');\n    \n    elementsWithStyle.forEach(el => {\n      const style = el.getAttribute('style');\n      const urls = this.extractUrlsFromCSS(style, baseUrl);\n      \n      urls.forEach(url => {\n        resources.other.push({\n          element: el,\n          originalUrl: url.originalUrl,\n          absoluteUrl: url.absoluteUrl,\n          type: 'inline-style'\n        });\n      });\n    });\n  }\n\n  /**\n   * 从CSS内容中提取URL\n   */\n  static extractUrlsFromCSS(cssContent, baseUrl) {\n    const urls = [];\n    const urlRegex = /url\\(\\s*[\"']?([^\"')]+)[\"']?\\s*\\)/g;\n    let match;\n\n    while ((match = urlRegex.exec(cssContent)) !== null) {\n      const originalUrl = match[1];\n      const absoluteUrl = this.resolveUrl(originalUrl, baseUrl);\n      urls.push({ originalUrl, absoluteUrl });\n    }\n\n    return urls;\n  }\n\n  /**\n   * 提取背景图片URL\n   */\n  static extractBackgroundUrls(styleContent, baseUrl) {\n    return this.extractUrlsFromCSS(styleContent, baseUrl);\n  }\n\n  /**\n   * 解析srcset属性\n   */\n  static parseSrcset(srcset, baseUrl) {\n    const urls = [];\n    const entries = srcset.split(',');\n    \n    entries.forEach(entry => {\n      const trimmed = entry.trim();\n      const parts = trimmed.split(/\\s+/);\n      if (parts.length > 0) {\n        const originalUrl = parts[0];\n        const absoluteUrl = this.resolveUrl(originalUrl, baseUrl);\n        urls.push({ originalUrl, absoluteUrl });\n      }\n    });\n\n    return urls;\n  }\n\n  /**\n   * 解析相对URL为绝对URL\n   */\n  static resolveUrl(url, baseUrl) {\n    try {\n      // 如果已经是绝对URL，直接返回\n      if (url.startsWith('http://') || url.startsWith('https://') || url.startsWith('//')) {\n        return url.startsWith('//') ? `https:${url}` : url;\n      }\n\n      // 如果是data URL或其他特殊协议，直接返回\n      if (url.startsWith('data:') || url.startsWith('blob:') || url.startsWith('javascript:')) {\n        return url;\n      }\n\n      // 解析相对URL\n      const base = new URL(baseUrl);\n      const resolved = new URL(url, base);\n      return resolved.toString();\n    } catch (error) {\n      console.warn(`[SmartIframe] URL解析失败: ${url} (base: ${baseUrl})`, error);\n      return url;\n    }\n  }\n\n  /**\n   * 获取所有资源URL列表\n   */\n  static getAllUrls(resources) {\n    const allUrls = [];\n    \n    Object.values(resources).forEach(resourceList => {\n      resourceList.forEach(resource => {\n        if (resource.absoluteUrl && !allUrls.includes(resource.absoluteUrl)) {\n          allUrls.push(resource.absoluteUrl);\n        }\n      });\n    });\n\n    return allUrls;\n  }\n\n  /**\n   * 重写HTML中的资源引用\n   * @param {Document} doc - DOM文档\n   * @param {Object} resourceMap - 资源映射表 {originalUrl: newUrl}\n   * @returns {string} 重写后的HTML\n   */\n  static rewriteResourceReferences(doc, resourceMap) {\n    // 重写link标签\n    doc.querySelectorAll('link[href]').forEach(link => {\n      const href = link.getAttribute('href');\n      const absoluteUrl = this.resolveUrl(href, window.location.href);\n      if (resourceMap[absoluteUrl]) {\n        link.setAttribute('href', resourceMap[absoluteUrl]);\n      }\n    });\n\n    // 重写script标签\n    doc.querySelectorAll('script[src]').forEach(script => {\n      const src = script.getAttribute('src');\n      const absoluteUrl = this.resolveUrl(src, window.location.href);\n      if (resourceMap[absoluteUrl]) {\n        script.setAttribute('src', resourceMap[absoluteUrl]);\n      }\n    });\n\n    // 重写img标签\n    doc.querySelectorAll('img[src]').forEach(img => {\n      const src = img.getAttribute('src');\n      const absoluteUrl = this.resolveUrl(src, window.location.href);\n      if (resourceMap[absoluteUrl]) {\n        img.setAttribute('src', resourceMap[absoluteUrl]);\n      }\n    });\n\n    // 重写style标签中的@import和url()\n    doc.querySelectorAll('style').forEach(style => {\n      let content = style.textContent;\n      \n      // 替换所有URL引用\n      content = content.replace(/url\\(\\s*[\"']?([^\"')]+)[\"']?\\s*\\)/g, (match, url) => {\n        const absoluteUrl = this.resolveUrl(url, window.location.href);\n        const newUrl = resourceMap[absoluteUrl] || url;\n        return match.replace(url, newUrl);\n      });\n\n      style.textContent = content;\n    });\n\n    return doc.documentElement.outerHTML;\n  }\n}\n\nexport default HtmlParser; ","import ResourceCache from './ResourceCache.js';\nimport HtmlParser from '../utils/htmlParser.js';\n\n/**\n * 渲染引擎 - 负责在Shadow DOM中渲染完整网页\n */\nclass Renderer {\n  constructor(container, options = {}) {\n    this.container = container;\n    this.options = {\n      sandbox: true,\n      loadImages: true,\n      loadScripts: true,\n      loadStyles: true,\n      ...options\n    };\n    \n    this.shadowRoot = null;\n    this.baseUrl = '';\n    this.resourceMap = new Map();\n    this.isRendered = false;\n  }\n\n  /**\n   * 渲染URL指定的网页\n   * @param {string} url - 要渲染的网页URL\n   * @returns {Promise<void>}\n   */\n  async renderUrl(url) {\n    try {\n      console.log(`[SmartIframe] 开始渲染: ${url}`);\n      this.baseUrl = url;\n\n      // 1. 获取HTML内容\n      const htmlResource = await ResourceCache.fetchWithCache(url);\n      \n      // 2. 解析HTML并提取资源\n      const parsed = HtmlParser.parseHTML(htmlResource.content, url);\n      \n      // 3. 预加载所有资源\n      if (parsed.allUrls.length > 0) {\n        await this.preloadResources(parsed.allUrls);\n      }\n\n      // 4. 创建Shadow DOM\n      this.createShadowRoot();\n\n      // 5. 处理CSS样式\n      await this.processStyles(parsed.resources.stylesheets);\n\n      // 6. 渲染HTML结构\n      this.renderHTML(parsed.document);\n\n      // 7. 处理JavaScript（如果启用）\n      if (this.options.loadScripts) {\n        await this.processScripts(parsed.resources.scripts);\n      }\n\n      // 8. 处理图片资源\n      if (this.options.loadImages) {\n        this.processImages(parsed.resources.images);\n      }\n\n      this.isRendered = true;\n      console.log(`[SmartIframe] 渲染完成: ${url}`);\n      \n      // 触发渲染完成事件\n      this.dispatchEvent('rendered', { url, resources: parsed.resources });\n\n    } catch (error) {\n      console.error(`[SmartIframe] 渲染失败: ${url}`, error);\n      this.dispatchEvent('error', { url, error });\n      throw error;\n    }\n  }\n\n  /**\n   * 创建Shadow DOM\n   */\n  createShadowRoot() {\n    if (this.shadowRoot) {\n      return;\n    }\n\n    // 检查容器是否已经有Shadow DOM\n    if (this.container.shadowRoot) {\n      this.shadowRoot = this.container.shadowRoot;\n      // 清空现有内容\n      this.shadowRoot.innerHTML = '';\n    } else {\n      this.shadowRoot = this.container.attachShadow({ \n        mode: 'closed',\n        delegatesFocus: false \n      });\n    }\n\n    // 添加基础样式重置\n    const resetStyle = document.createElement('style');\n    resetStyle.textContent = `\n      :host {\n        display: block;\n        width: 100%;\n        height: 100%;\n        overflow: auto;\n      }\n      \n      html, body {\n        margin: 0;\n        padding: 0;\n        width: 100%;\n        height: 100%;\n      }\n    `;\n    \n    this.shadowRoot.appendChild(resetStyle);\n  }\n\n  /**\n   * 预加载资源\n   * @param {Array<string>} urls - 资源URL列表\n   */\n  async preloadResources(urls) {\n    const filteredUrls = urls.filter(url => {\n      // 过滤掉不需要预加载的资源\n      return !url.startsWith('data:') && \n             !url.startsWith('blob:') && \n             !url.startsWith('javascript:');\n    });\n\n    if (filteredUrls.length > 0) {\n      await ResourceCache.preloadResources(filteredUrls);\n    }\n  }\n\n  /**\n   * 处理CSS样式\n   * @param {Array} stylesheets - CSS资源列表\n   */\n  async processStyles(stylesheets) {\n    if (!this.options.loadStyles) {\n      return;\n    }\n\n    for (const stylesheet of stylesheets) {\n      try {\n        if (stylesheet.type === 'stylesheet') {\n          const cssResource = await ResourceCache.fetchWithCache(stylesheet.absoluteUrl);\n          const processedCSS = await this.processCSSContent(cssResource.content, stylesheet.absoluteUrl);\n          \n          const style = document.createElement('style');\n          style.textContent = processedCSS;\n          this.shadowRoot.appendChild(style);\n          \n        } else if (stylesheet.type === 'import') {\n          // 处理@import\n          const cssResource = await ResourceCache.fetchWithCache(stylesheet.absoluteUrl);\n          const processedCSS = await this.processCSSContent(cssResource.content, stylesheet.absoluteUrl);\n          \n          // 替换原来的@import\n          const parentStyle = stylesheet.parentStyle;\n          if (parentStyle) {\n            let content = parentStyle.textContent;\n            content = content.replace(\n              new RegExp(`@import\\\\s+(?:url\\\\()?[\"']?${stylesheet.originalUrl.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')}[\"']?\\\\)?[^;]*;`),\n              processedCSS\n            );\n            parentStyle.textContent = content;\n          }\n        }\n      } catch (error) {\n        console.warn(`[SmartIframe] CSS加载失败: ${stylesheet.absoluteUrl}`, error);\n      }\n    }\n  }\n\n  /**\n   * 处理CSS内容，解析其中的url()引用\n   * @param {string} cssContent - CSS内容\n   * @param {string} baseUrl - CSS文件的基础URL\n   * @returns {Promise<string>} 处理后的CSS内容\n   */\n  async processCSSContent(cssContent, baseUrl) {\n    // 提取CSS中的所有URL引用\n    const urlRegex = /url\\(\\s*[\"']?([^\"')]+)[\"']?\\s*\\)/g;\n    const urls = [];\n    let match;\n\n    while ((match = urlRegex.exec(cssContent)) !== null) {\n      const url = match[1];\n      if (!url.startsWith('data:') && !url.startsWith('blob:')) {\n        const absoluteUrl = HtmlParser.resolveUrl(url, baseUrl);\n        urls.push({ originalUrl: url, absoluteUrl });\n      }\n    }\n\n    // 预加载这些资源\n    if (urls.length > 0) {\n      const urlList = urls.map(u => u.absoluteUrl);\n      await ResourceCache.preloadResources(urlList);\n    }\n\n    // 替换URL引用为缓存的blob URL\n    let processedCSS = cssContent;\n    for (const urlInfo of urls) {\n      try {\n        const resource = await ResourceCache.fetchWithCache(urlInfo.absoluteUrl);\n        if (resource && resource.content) {\n          // 如果是blob URL，直接使用\n          const newUrl = resource.content.startsWith('blob:') ? resource.content : `data:${resource.contentType};base64,${btoa(resource.content)}`;\n          processedCSS = processedCSS.replace(\n            new RegExp(`url\\\\(\\\\s*[\"']?${urlInfo.originalUrl.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')}[\"']?\\\\s*\\\\)`, 'g'),\n            `url(${newUrl})`\n          );\n        }\n      } catch (error) {\n        console.warn(`[SmartIframe] CSS资源处理失败: ${urlInfo.absoluteUrl}`, error);\n      }\n    }\n\n    return processedCSS;\n  }\n\n  /**\n   * 渲染HTML结构\n   * @param {Document} doc - 解析后的文档\n   */\n  renderHTML(doc) {\n    // 克隆body内容到shadow root\n    const body = doc.body;\n    if (body) {\n      // 创建一个容器div\n      const container = document.createElement('div');\n      container.innerHTML = body.innerHTML;\n      \n      // 处理所有图片的src属性\n      this.processImageElements(container);\n      \n      this.shadowRoot.appendChild(container);\n    }\n  }\n\n  /**\n   * 处理图片元素\n   * @param {Element} container - 容器元素\n   */\n  processImageElements(container) {\n    const images = container.querySelectorAll('img');\n    \n    images.forEach(async (img) => {\n      const src = img.getAttribute('src');\n      if (src && !src.startsWith('data:') && !src.startsWith('blob:')) {\n        try {\n          const absoluteUrl = HtmlParser.resolveUrl(src, this.baseUrl);\n          const resource = await ResourceCache.fetchWithCache(absoluteUrl);\n          \n          if (resource && resource.content) {\n            if (resource.content.startsWith('blob:')) {\n              img.src = resource.content;\n            } else {\n              // 转换为data URL\n              img.src = `data:${resource.contentType};base64,${btoa(resource.content)}`;\n            }\n          }\n        } catch (error) {\n          console.warn(`[SmartIframe] 图片加载失败: ${src}`, error);\n        }\n      }\n    });\n  }\n\n  /**\n   * 处理JavaScript脚本\n   * @param {Array} scripts - 脚本资源列表\n   */\n  async processScripts(scripts) {\n    if (!this.options.sandbox) {\n      console.warn('[SmartIframe] 脚本执行需要沙箱环境，跳过JavaScript处理');\n      return;\n    }\n\n    for (const script of scripts) {\n      try {\n        const jsResource = await ResourceCache.fetchWithCache(script.absoluteUrl);\n        \n        // 在沙箱环境中执行脚本\n        this.executeScriptInSandbox(jsResource.content, script.absoluteUrl);\n        \n      } catch (error) {\n        console.warn(`[SmartIframe] 脚本加载失败: ${script.absoluteUrl}`, error);\n      }\n    }\n  }\n\n  /**\n   * 在沙箱中执行脚本\n   * @param {string} scriptContent - 脚本内容\n   * @param {string} scriptUrl - 脚本URL\n   */\n  executeScriptInSandbox(scriptContent, scriptUrl) {\n    try {\n      // 创建一个受限的执行环境\n      const sandbox = {\n        console,\n        setTimeout,\n        setInterval,\n        clearTimeout,\n        clearInterval,\n        document: this.shadowRoot,\n        window: new Proxy({}, {\n          get: (target, prop) => {\n            // 只允许访问安全的属性\n            const allowedProps = ['console', 'setTimeout', 'setInterval', 'clearTimeout', 'clearInterval'];\n            if (allowedProps.includes(prop)) {\n              return sandbox[prop];\n            }\n            return undefined;\n          }\n        })\n      };\n\n      // 使用Function构造器创建沙箱环境\n      const func = new Function('sandbox', `\n        with(sandbox) {\n          ${scriptContent}\n        }\n      `);\n\n      func(sandbox);\n      \n    } catch (error) {\n      console.error(`[SmartIframe] 脚本执行失败: ${scriptUrl}`, error);\n    }\n  }\n\n  /**\n   * 处理图片资源\n   * @param {Array} images - 图片资源列表\n   */\n  processImages(images) {\n    // 图片处理已经在renderHTML中进行了\n    console.log(`[SmartIframe] 处理了 ${images.length} 个图片资源`);\n  }\n\n  /**\n   * 触发自定义事件\n   * @param {string} eventName - 事件名称\n   * @param {Object} detail - 事件详情\n   */\n  dispatchEvent(eventName, detail = {}) {\n    const event = new CustomEvent(`smartiframe:${eventName}`, {\n      detail,\n      bubbles: true,\n      cancelable: true\n    });\n    \n    this.container.dispatchEvent(event);\n  }\n\n  /**\n   * 销毁渲染器\n   */\n  destroy() {\n    if (this.shadowRoot) {\n      this.shadowRoot.innerHTML = '';\n    }\n    \n    this.resourceMap.clear();\n    this.isRendered = false;\n    \n    console.log('[SmartIframe] 渲染器已销毁');\n  }\n\n  /**\n   * 获取渲染统计信息\n   * @returns {Object} 统计信息\n   */\n  getStats() {\n    return {\n      isRendered: this.isRendered,\n      baseUrl: this.baseUrl,\n      resourceCount: this.resourceMap.size,\n      cacheStats: ResourceCache.getCacheStats()\n    };\n  }\n}\n\nexport default Renderer; ","import Renderer from './Renderer.js';\nimport ResourceCache from './ResourceCache.js';\n\n/**\n * SmartIframe - 智能iframe替代方案的核心组件\n */\nclass SmartIframe {\n  constructor(container, options = {}) {\n    this.container = this.resolveContainer(container);\n    this.options = {\n      width: '100%',\n      height: '400px',\n      sandbox: true,\n      loadImages: true,\n      loadScripts: false, // 默认关闭脚本执行，提高安全性\n      loadStyles: true,\n      cache: true,\n      ...options\n    };\n\n    this.src = '';\n    this.renderer = null;\n    this.isLoading = false;\n    this.isLoaded = false;\n    \n    this.init();\n  }\n\n  /**\n   * 解析容器元素\n   * @param {string|Element} container - 容器选择器或元素\n   * @returns {Element} 容器元素\n   */\n  resolveContainer(container) {\n    if (typeof container === 'string') {\n      const element = document.querySelector(container);\n      if (!element) {\n        throw new Error(`[SmartIframe] 找不到容器元素: ${container}`);\n      }\n      return element;\n    } else if (container instanceof Element) {\n      return container;\n    } else {\n      throw new Error('[SmartIframe] 无效的容器参数');\n    }\n  }\n\n  /**\n   * 初始化组件\n   */\n  init() {\n    this.setupContainer();\n    this.setupEventListeners();\n    this.renderer = new Renderer(this.container, this.options);\n  }\n\n  /**\n   * 设置容器样式\n   */\n  setupContainer() {\n    // 设置容器基础样式\n    Object.assign(this.container.style, {\n      width: this.options.width,\n      height: this.options.height,\n      border: 'none',\n      overflow: 'hidden',\n      display: 'block'\n    });\n\n    // 添加SmartIframe标识\n    this.container.setAttribute('data-smart-iframe', 'true');\n    this.container.classList.add('smart-iframe-container');\n  }\n\n  /**\n   * 设置事件监听器\n   */\n  setupEventListeners() {\n    // 监听渲染事件\n    this.container.addEventListener('smartiframe:rendered', (e) => {\n      this.isLoading = false;\n      this.isLoaded = true;\n      this.dispatchEvent('load', e.detail);\n    });\n\n    // 监听错误事件\n    this.container.addEventListener('smartiframe:error', (e) => {\n      this.isLoading = false;\n      this.isLoaded = false;\n      this.dispatchEvent('error', e.detail);\n    });\n  }\n\n  /**\n   * 加载指定URL的内容\n   * @param {string} url - 要加载的URL\n   * @returns {Promise<void>}\n   */\n  async load(url) {\n    if (!url) {\n      throw new Error('[SmartIframe] URL不能为空');\n    }\n\n    if (this.isLoading) {\n      console.warn('[SmartIframe] 正在加载中，忽略新的加载请求');\n      return;\n    }\n\n    try {\n      this.isLoading = true;\n      this.isLoaded = false;\n      this.src = url;\n\n      // 显示加载状态\n      this.showLoadingState();\n\n      // 使用渲染器加载内容\n      await this.renderer.renderUrl(url);\n\n      // 隐藏加载状态\n      this.hideLoadingState();\n\n    } catch (error) {\n      this.hideLoadingState();\n      this.showErrorState(error);\n      throw error;\n    }\n  }\n\n  /**\n   * 显示加载状态\n   */\n  showLoadingState() {\n    this.container.innerHTML = `\n      <div class=\"smart-iframe-loading\" style=\"\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        height: 100%;\n        font-family: Arial, sans-serif;\n        color: #666;\n        background: #f5f5f5;\n      \">\n        <div style=\"text-align: center;\">\n          <div style=\"\n            width: 40px;\n            height: 40px;\n            border: 3px solid #e0e0e0;\n            border-top: 3px solid #007bff;\n            border-radius: 50%;\n            animation: spin 1s linear infinite;\n            margin: 0 auto 10px;\n          \"></div>\n          <div>正在加载...</div>\n        </div>\n        <style>\n          @keyframes spin {\n            0% { transform: rotate(0deg); }\n            100% { transform: rotate(360deg); }\n          }\n        </style>\n      </div>\n    `;\n  }\n\n  /**\n   * 隐藏加载状态\n   */\n  hideLoadingState() {\n    const loadingElement = this.container.querySelector('.smart-iframe-loading');\n    if (loadingElement) {\n      loadingElement.remove();\n    }\n  }\n\n  /**\n   * 显示错误状态\n   * @param {Error} error - 错误对象\n   */\n  showErrorState(error) {\n    this.container.innerHTML = `\n      <div class=\"smart-iframe-error\" style=\"\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        height: 100%;\n        font-family: Arial, sans-serif;\n        background: #fff;\n        border: 1px solid #ddd;\n      \">\n        <div style=\"text-align: center; color: #666; padding: 20px;\">\n          <div style=\"font-size: 48px; margin-bottom: 10px;\">⚠️</div>\n          <div style=\"font-size: 16px; margin-bottom: 10px;\">加载失败</div>\n          <div style=\"font-size: 14px; color: #999;\">${error.message}</div>\n          <button onclick=\"this.closest('.smart-iframe-container').smartIframe.reload()\" \n                  style=\"\n                    margin-top: 15px;\n                    padding: 8px 16px;\n                    background: #007bff;\n                    color: white;\n                    border: none;\n                    border-radius: 4px;\n                    cursor: pointer;\n                  \">\n            重新加载\n          </button>\n        </div>\n      </div>\n    `;\n  }\n\n  /**\n   * 重新加载当前URL\n   * @returns {Promise<void>}\n   */\n  async reload() {\n    if (this.src) {\n      // 清除该URL的缓存\n      if (this.options.cache) {\n        ResourceCache.clearCache(this.src);\n      }\n      await this.load(this.src);\n    }\n  }\n\n  /**\n   * 设置src属性（类似iframe的src）\n   * @param {string} url - URL\n   */\n  set src(url) {\n    this._src = url;\n    if (url) {\n      this.load(url).catch(error => {\n        console.error('[SmartIframe] 自动加载失败:', error);\n      });\n    }\n  }\n\n  /**\n   * 获取src属性\n   * @returns {string} 当前的URL\n   */\n  get src() {\n    return this._src || '';\n  }\n\n  /**\n   * 设置宽度\n   * @param {string} width - 宽度值\n   */\n  set width(width) {\n    this.options.width = width;\n    this.container.style.width = width;\n  }\n\n  /**\n   * 获取宽度\n   * @returns {string} 当前宽度\n   */\n  get width() {\n    return this.options.width;\n  }\n\n  /**\n   * 设置高度\n   * @param {string} height - 高度值\n   */\n  set height(height) {\n    this.options.height = height;\n    this.container.style.height = height;\n  }\n\n  /**\n   * 获取高度\n   * @returns {string} 当前高度\n   */\n  get height() {\n    return this.options.height;\n  }\n\n  /**\n   * 获取加载状态\n   * @returns {boolean} 是否正在加载\n   */\n  get loading() {\n    return this.isLoading;\n  }\n\n  /**\n   * 获取加载完成状态\n   * @returns {boolean} 是否已加载完成\n   */\n  get loaded() {\n    return this.isLoaded;\n  }\n\n  /**\n   * 触发自定义事件\n   * @param {string} eventName - 事件名称\n   * @param {Object} detail - 事件详情\n   */\n  dispatchEvent(eventName, detail = {}) {\n    const event = new CustomEvent(eventName, {\n      detail,\n      bubbles: true,\n      cancelable: true\n    });\n    \n    this.container.dispatchEvent(event);\n  }\n\n  /**\n   * 销毁组件\n   */\n  destroy() {\n    if (this.renderer) {\n      this.renderer.destroy();\n      this.renderer = null;\n    }\n\n    // 清理容器内容，但保留Shadow DOM结构以便重用\n    if (this.container.shadowRoot) {\n      this.container.shadowRoot.innerHTML = '';\n    } else {\n      this.container.innerHTML = '';\n    }\n    \n    this.container.removeAttribute('data-smart-iframe');\n    this.container.classList.remove('smart-iframe-container');\n    \n    this.isLoading = false;\n    this.isLoaded = false;\n    this._src = '';\n\n    console.log('[SmartIframe] 组件已销毁');\n  }\n\n  /**\n   * 获取统计信息\n   * @returns {Object} 统计信息\n   */\n  getStats() {\n    return {\n      src: this.src,\n      loading: this.isLoading,\n      loaded: this.isLoaded,\n      renderer: this.renderer ? this.renderer.getStats() : null\n    };\n  }\n\n  /**\n   * 静态方法：创建SmartIframe实例\n   * @param {string|Element} container - 容器\n   * @param {Object} options - 选项\n   * @returns {SmartIframe} SmartIframe实例\n   */\n  static create(container, options = {}) {\n    return new SmartIframe(container, options);\n  }\n\n  /**\n   * 静态方法：获取缓存统计\n   * @returns {Object} 缓存统计信息\n   */\n  static getCacheStats() {\n    return ResourceCache.getCacheStats();\n  }\n\n  /**\n   * 静态方法：清除所有缓存\n   */\n  static clearAllCache() {\n    ResourceCache.clearCache();\n  }\n}\n\nexport default SmartIframe; ","import SmartIframe from '../core/SmartIframe.js';\n\n/**\n * SmartIframe Web Component\n * 使用方式：<smart-iframe src=\"https://example.com\" width=\"800\" height=\"600\"></smart-iframe>\n */\nclass SmartIframeElement extends HTMLElement {\n  constructor() {\n    super();\n    this.smartIframe = null;\n    this.isConnected = false;\n  }\n\n  /**\n   * 定义观察的属性\n   */\n  static get observedAttributes() {\n    return ['src', 'width', 'height', 'sandbox', 'load-images', 'load-scripts', 'load-styles'];\n  }\n\n  /**\n   * 元素连接到DOM时调用\n   */\n  connectedCallback() {\n    this.isConnected = true;\n    this.render();\n  }\n\n  /**\n   * 元素从DOM断开时调用\n   */\n  disconnectedCallback() {\n    this.isConnected = false;\n    if (this.smartIframe) {\n      this.smartIframe.destroy();\n      this.smartIframe = null;\n    }\n  }\n\n  /**\n   * 属性变化时调用\n   */\n  attributeChangedCallback(name, oldValue, newValue) {\n    if (!this.isConnected || oldValue === newValue) {\n      return;\n    }\n\n    switch (name) {\n      case 'src':\n        if (this.smartIframe && newValue) {\n          this.smartIframe.src = newValue;\n        }\n        break;\n      case 'width':\n        if (this.smartIframe && newValue) {\n          this.smartIframe.width = newValue;\n        }\n        break;\n      case 'height':\n        if (this.smartIframe && newValue) {\n          this.smartIframe.height = newValue;\n        }\n        break;\n      default:\n        // 其他属性变化时重新渲染\n        this.render();\n        break;\n    }\n  }\n\n  /**\n   * 渲染组件\n   */\n  render() {\n    if (this.smartIframe) {\n      this.smartIframe.destroy();\n    }\n\n    // 创建容器div\n    const container = document.createElement('div');\n    container.style.width = '100%';\n    container.style.height = '100%';\n    \n    this.innerHTML = '';\n    this.appendChild(container);\n\n    // 解析配置选项\n    const options = {\n      width: this.getAttribute('width') || '100%',\n      height: this.getAttribute('height') || '400px',\n      sandbox: this.getAttribute('sandbox') !== 'false',\n      loadImages: this.getAttribute('load-images') !== 'false',\n      loadScripts: this.getAttribute('load-scripts') === 'true',\n      loadStyles: this.getAttribute('load-styles') !== 'false'\n    };\n\n    // 创建SmartIframe实例\n    this.smartIframe = new SmartIframe(container, options);\n    \n    // 绑定到容器元素\n    container.smartIframe = this.smartIframe;\n\n    // 设置事件监听\n    this.setupEventListeners();\n\n    // 如果有src属性，立即加载\n    const src = this.getAttribute('src');\n    if (src) {\n      this.smartIframe.load(src).catch(error => {\n        console.error('[SmartIframeElement] 加载失败:', error);\n      });\n    }\n  }\n\n  /**\n   * 设置事件监听器\n   */\n  setupEventListeners() {\n    const container = this.querySelector('div');\n    if (!container) return;\n\n    // 转发SmartIframe的事件\n    container.addEventListener('load', (e) => {\n      this.dispatchEvent(new CustomEvent('load', {\n        detail: e.detail,\n        bubbles: true\n      }));\n    });\n\n    container.addEventListener('error', (e) => {\n      this.dispatchEvent(new CustomEvent('error', {\n        detail: e.detail,\n        bubbles: true\n      }));\n    });\n  }\n\n  /**\n   * src属性的getter\n   */\n  get src() {\n    return this.getAttribute('src') || '';\n  }\n\n  /**\n   * src属性的setter\n   */\n  set src(value) {\n    if (value) {\n      this.setAttribute('src', value);\n    } else {\n      this.removeAttribute('src');\n    }\n  }\n\n  /**\n   * width属性的getter\n   */\n  get width() {\n    return this.getAttribute('width') || '100%';\n  }\n\n  /**\n   * width属性的setter\n   */\n  set width(value) {\n    if (value) {\n      this.setAttribute('width', value);\n    } else {\n      this.removeAttribute('width');\n    }\n  }\n\n  /**\n   * height属性的getter\n   */\n  get height() {\n    return this.getAttribute('height') || '400px';\n  }\n\n  /**\n   * height属性的setter\n   */\n  set height(value) {\n    if (value) {\n      this.setAttribute('height', value);\n    } else {\n      this.removeAttribute('height');\n    }\n  }\n\n  /**\n   * 获取加载状态\n   */\n  get loading() {\n    return this.smartIframe ? this.smartIframe.loading : false;\n  }\n\n  /**\n   * 获取加载完成状态\n   */\n  get loaded() {\n    return this.smartIframe ? this.smartIframe.loaded : false;\n  }\n\n  /**\n   * 重新加载\n   */\n  async reload() {\n    if (this.smartIframe) {\n      await this.smartIframe.reload();\n    }\n  }\n\n  /**\n   * 获取统计信息\n   */\n  getStats() {\n    return this.smartIframe ? this.smartIframe.getStats() : null;\n  }\n}\n\n// 注册自定义元素\nif (!customElements.get('smart-iframe')) {\n  customElements.define('smart-iframe', SmartIframeElement);\n}\n\nexport default SmartIframeElement; ","/**\n * Smart-Iframe SDK\n * 智能iframe替代方案，解决资源重复加载问题\n * \n * 使用方式：\n * 1. ES6 模块：import SmartIframe from 'smart-iframe-sdk'\n * 2. CommonJS：const SmartIframe = require('smart-iframe-sdk')\n * 3. 全局变量：<script src=\"smart-iframe.min.js\"></script>\n * 4. Web Components：<smart-iframe src=\"https://example.com\"></smart-iframe>\n */\n\nimport SmartIframe from './core/SmartIframe.js';\nimport ResourceCache from './core/ResourceCache.js';\nimport Renderer from './core/Renderer.js';\nimport HtmlParser from './utils/htmlParser.js';\nimport SmartIframeElement from './web-components/SmartIframeElement.js';\n\n/**\n * 版本信息\n */\nconst VERSION = '1.0.0';\n\n/**\n * 快速创建SmartIframe实例的工厂函数\n * @param {string|Element} container - 容器选择器或元素\n * @param {Object} options - 配置选项\n * @returns {SmartIframe} SmartIframe实例\n */\nfunction create(container, options = {}) {\n  return new SmartIframe(container, options);\n}\n\n/**\n * 快速加载网页到指定容器\n * @param {string|Element} container - 容器选择器或元素\n * @param {string} url - 要加载的URL\n * @param {Object} options - 配置选项\n * @returns {Promise<SmartIframe>} SmartIframe实例\n */\nasync function load(container, url, options = {}) {\n  const iframe = new SmartIframe(container, options);\n  await iframe.load(url);\n  return iframe;\n}\n\n/**\n * 注册自定义元素到全局\n * 调用后可以在HTML中使用 <smart-iframe> 标签\n */\nfunction registerWebComponent() {\n  if (typeof window !== 'undefined' && window.customElements) {\n    // SmartIframeElement 会自动注册，这里只是确保\n    console.log('[SmartIframe] Web Component 已注册');\n  } else {\n    console.warn('[SmartIframe] 当前环境不支持 Web Components');\n  }\n}\n\n/**\n * 获取SDK信息\n * @returns {Object} SDK信息\n */\nfunction getInfo() {\n  return {\n    name: 'smart-iframe-sdk',\n    version: VERSION,\n    description: '智能iframe替代方案，解决资源重复加载问题',\n    author: 'Smart-Iframe Team',\n    license: 'MIT',\n    cacheStats: ResourceCache.getCacheStats()\n  };\n}\n\n/**\n * 清除所有缓存\n */\nfunction clearCache() {\n  ResourceCache.clearCache();\n  console.log('[SmartIframe] 已清除所有缓存');\n}\n\n/**\n * 设置全局配置\n * @param {Object} config - 全局配置\n */\nfunction setGlobalConfig(config = {}) {\n  if (config.maxCacheSize) {\n    ResourceCache.maxCacheSize = config.maxCacheSize;\n  }\n  \n  if (config.maxAge) {\n    ResourceCache.maxAge = config.maxAge;\n  }\n  \n  console.log('[SmartIframe] 全局配置已更新:', config);\n}\n\n/**\n * 批量预加载URL列表\n * @param {Array<string>} urls - URL列表\n * @returns {Promise<Array>} 预加载结果\n */\nasync function preload(urls) {\n  if (!Array.isArray(urls)) {\n    throw new Error('[SmartIframe] preload 参数必须是数组');\n  }\n  \n  console.log(`[SmartIframe] 开始批量预加载 ${urls.length} 个URL`);\n  return await ResourceCache.preloadResources(urls);\n}\n\n/**\n * 检查浏览器兼容性\n * @returns {Object} 兼容性检查结果\n */\nfunction checkCompatibility() {\n  const isSupported = {\n    shadowDOM: !!Element.prototype.attachShadow,\n    webComponents: typeof customElements !== 'undefined',\n    fetch: typeof fetch !== 'undefined',\n    proxy: typeof Proxy !== 'undefined',\n    asyncAwait: true, // 如果代码能执行到这里就支持\n    es6Classes: true,  // 如果代码能执行到这里就支持\n    es6Modules: true   // 简化检测，如果能导入就支持\n  };\n  \n  const allSupported = Object.values(isSupported).every(Boolean);\n  \n  return {\n    supported: allSupported,\n    features: isSupported,\n    recommendation: allSupported \n      ? '✅ 浏览器完全兼容SmartIframe SDK' \n      : '⚠️ 部分功能可能不可用，建议使用现代浏览器'\n  };\n}\n\n// 默认导出主类\nexport default SmartIframe;\n\n// 命名导出所有API\nexport {\n  SmartIframe,\n  ResourceCache,\n  Renderer,\n  HtmlParser,\n  SmartIframeElement,\n  VERSION,\n  create,\n  load,\n  registerWebComponent,\n  getInfo,\n  clearCache,\n  setGlobalConfig,\n  preload,\n  checkCompatibility\n};\n\n// 如果在浏览器环境中，自动注册到全局\nif (typeof window !== 'undefined') {\n  // 注册到全局对象\n  window.SmartIframe = SmartIframe;\n  window.SmartIframeSDK = {\n    SmartIframe,\n    create,\n    load,\n    registerWebComponent,\n    getInfo,\n    clearCache,\n    setGlobalConfig,\n    preload,\n    checkCompatibility,\n    version: VERSION\n  };\n  \n  // 自动注册Web Component\n  registerWebComponent();\n  \n  console.log(`[SmartIframe] SDK v${VERSION} 已加载`);\n  console.log('[SmartIframe] 兼容性检查:', checkCompatibility());\n}\n\n// 如果是CommonJS环境\nif (typeof module !== 'undefined' && module.exports) {\n  module.exports = SmartIframe;\n  module.exports.default = SmartIframe;\n  module.exports.create = create;\n  module.exports.load = load;\n  module.exports.getInfo = getInfo;\n  module.exports.clearCache = clearCache;\n  module.exports.setGlobalConfig = setGlobalConfig;\n  module.exports.preload = preload;\n  module.exports.checkCompatibility = checkCompatibility;\n  module.exports.version = VERSION;\n} "],"names":["ResourceCache","cache","Map","pendingRequests","maxCacheSize","maxAge","fetchWithCache","url","options","normalizedUrl","normalizeUrl","has","cached","get","Date","now","timestamp","console","log","delete","requestPromise","performRequest","set","result","addToCache","error","response","fetch","mode","ok","Error","status","statusText","contentType","headers","content","includes","text","blob","URL","createObjectURL","size","length","urlObj","window","location","href","hash","toString","warn","data","oldestKey","keys","next","value","clearCache","clear","getCacheStats","totalSize","Array","from","values","reduce","sum","item","count","maxSize","preloadResources","urls","promises","map","catch","results","Promise","all","successCount","filter","r","HtmlParser","parseHTML","html","baseUrl","parser","DOMParser","doc","parseFromString","resources","stylesheets","scripts","images","links","other","extractStylesheets","extractScripts","extractImages","extractOtherLinks","extractInlineStyleUrls","document","allUrls","getAllUrls","querySelectorAll","forEach","link","getAttribute","absoluteUrl","resolveUrl","push","element","originalUrl","type","styleTags","style","textContent","importMatches","match","urlMatch","parentStyle","script","src","async","hasAttribute","defer","module","img","srcset","srcsetUrls","parseSrcset","elementsWithBg","el","bgUrls","extractBackgroundUrls","rel","otherElements","tagName","toLowerCase","elementsWithStyle","extractUrlsFromCSS","cssContent","urlRegex","exec","styleContent","entries","split","entry","trimmed","trim","parts","startsWith","base","resolved","Object","resourceList","resource","rewriteResourceReferences","resourceMap","setAttribute","replace","newUrl","documentElement","outerHTML","Renderer","constructor","container","sandbox","loadImages","loadScripts","loadStyles","shadowRoot","isRendered","renderUrl","htmlResource","parsed","createShadowRoot","processStyles","renderHTML","processScripts","processImages","dispatchEvent","innerHTML","attachShadow","delegatesFocus","resetStyle","createElement","appendChild","filteredUrls","stylesheet","cssResource","processedCSS","processCSSContent","RegExp","urlList","u","urlInfo","btoa","body","processImageElements","jsResource","executeScriptInSandbox","scriptContent","scriptUrl","setTimeout","setInterval","clearTimeout","clearInterval","Proxy","target","prop","allowedProps","undefined","func","Function","eventName","detail","event","CustomEvent","bubbles","cancelable","destroy","getStats","resourceCount","cacheStats","SmartIframe","resolveContainer","width","height","renderer","isLoading","isLoaded","init","querySelector","Element","setupContainer","setupEventListeners","assign","border","overflow","display","classList","add","addEventListener","e","load","showLoadingState","hideLoadingState","showErrorState","loadingElement","remove","message","reload","_src","loading","loaded","removeAttribute","create","clearAllCache","SmartIframeElement","HTMLElement","smartIframe","isConnected","observedAttributes","connectedCallback","render","disconnectedCallback","attributeChangedCallback","name","oldValue","newValue","customElements","define","VERSION","iframe","registerWebComponent","getInfo","version","description","author","license","setGlobalConfig","config","preload","isArray","checkCompatibility","isSupported","shadowDOM","prototype","webComponents","proxy","asyncAwait","es6Classes","es6Modules","allSupported","every","Boolean","supported","features","recommendation","SmartIframeSDK","exports","default"],"mappings":"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"}